import './polyfills.server.mjs';
import{b as j,d as N,e as z,f as F,g as V,h as $,q as B}from"./chunk-XJUS552I.mjs";import{$ as S,Ab as y,Cb as A,Oa as r,Pa as M,Q as v,bb as b,db as s,g as _,gb as c,hb as d,ia as g,ja as m,lb as C,mb as x,nb as l,nc as k,oc as I,pc as T,sc as E,ub as u,vb as O,yb as w,zb as P}from"./chunk-W7AEZ4IQ.mjs";import{a as h,h as p}from"./chunk-VVCT4QZE.mjs";var L=(()=>{class i{constructor(){this.context$=new _({currentSection:"home"})}getContext(){return this.context$.asObservable()}setContext(e){let t=this.context$.value;this.context$.next(h(h({},t),e))}getCurrent(){return this.context$.value}resetContext(){this.context$.next({currentSection:"home"})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275prov=v({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function W(i,f){if(i&1&&(c(0,"div",6)(1,"div",7),u(2),d()()),i&2){let e=f.$implicit;s("ngClass",e.sender),r(2),O(e.text)}}function D(i,f){i&1&&(c(0,"div",8)(1,"div",7),u(2,"Enviando cotizaci\xF3n..."),d()())}function G(i,f){if(i&1){let e=C();c(0,"form",9),x("ngSubmit",function(){g(e);let n=l();return m(n.sendMessage())}),c(1,"input",10),y("ngModelChange",function(n){g(e);let o=l();return P(o.userInput,n)||(o.userInput=n),m(n)}),d(),c(2,"button",11),u(3,"Enviar"),d()()}if(i&2){let e=l();r(),w("ngModel",e.userInput),s("disabled",e.sending),r(),s("disabled",!e.userInput.trim()||e.sending)}}function H(i,f){if(i&1){let e=C();c(0,"div",12)(1,"button",13),x("click",function(){g(e);let n=l();return m(n.restart())}),u(2,"Nueva cotizaci\xF3n"),d()()}}var Z=(()=>{class i{constructor(e){this.context=e,this.messages=[{sender:"bot",text:"\xA1Hola! Soy tu asistente para cotizaciones. \xBFEn qu\xE9 puedo ayudarte hoy?"}],this.userInput="",this.step=0,this.data={},this.sending=!1,this.finished=!1,this.sendError=!1,this.context.setContext({currentSection:"brief",briefType:void 0})}sendMessage(){return p(this,null,function*(){let e=this.userInput.trim();if(!e)return;this.messages.push({sender:"user",text:e}),this.userInput="";let t=this.analyzeSentiment(e);this.context.setContext({lastAction:"user_message",lastMessage:e,sentiment:t}),yield this.handleConversation(e)})}analyzeSentiment(e){let t=/(gracias|excelente|perfecto|me gusta|feliz|genial|bien|content[ao])/i,n=/(mal|problema|no me gusta|triste|caro|difÃ­cil|complicado|frustrad[ao])/i;return t.test(e)?"positivo":n.test(e)?"negativo":"neutral"}handleConversation(e){return p(this,null,function*(){if(!this.data.projectType){let t=["landing","web","ecommerce","ia","app","tienda","institucional"],n=e.toLowerCase(),o=t.find(a=>n.includes(a));o?(this.data.projectType=o,this.context.setContext({briefType:o}),this.messages.push({sender:"bot",text:`\xA1Genial! \xBFCu\xE1l es el objetivo principal de tu ${o}?`})):this.messages.push({sender:"bot",text:"Ofrecemos desarrollo de landings, webs institucionales, ecommerce, integraci\xF3n IA y apps a medida. \xBFQu\xE9 tipo de proyecto te interesa?"});return}if(!this.data.goal){this.data.goal=e,this.messages.push({sender:"bot",text:"\xBFQu\xE9 funcionalidades clave necesitas? (Ej: blog, contacto, pagos, admin, etc.)"});return}if(!this.data.features){this.data.features=e,this.context.setContext({features:e}),this.messages.push({sender:"bot",text:'\xA1Perfecto! Con estos datos puedo prepararte una cotizaci\xF3n estimada. \xBFTe gustar\xEDa recibirla por email o WhatsApp? (Opcional, puedes responder "no" si prefieres solo ver la estimaci\xF3n aqu\xED)'});return}if(!this.data.contactAsked){let t=e.toLowerCase();if(t.includes("no")){yield this.sendQuote(),this.data.contactAsked=!0;return}if(/\S+@\S+\.\S+/.test(e)||/\d{7,}/.test(e)){this.data.contact=e,this.context.setContext({contact:e}),yield this.sendQuote(),this.data.contactAsked=!0;return}if(t.includes("s\xED")||t.includes("ok")||t.includes("whatsapp")||t.includes("email")){this.messages.push({sender:"bot",text:"\xA1Genial! Por favor, ind\xEDcame tu email o WhatsApp para enviarte la propuesta."}),this.data.contactAsked=!0;return}this.messages.push({sender:"bot",text:'\xBFTe gustar\xEDa recibir la propuesta por email o WhatsApp? Si prefieres no dejar datos, responde "no".'});return}if(this.finished){this.messages.push({sender:"bot",text:"\xBFTe gustar\xEDa afinar detalles, agendar una llamada o tienes otra consulta?"});return}this.messages.push({sender:"bot",text:"\xBFTe gustar\xEDa continuar con la cotizaci\xF3n o tienes otra consulta?"})})}sendQuote(){return p(this,null,function*(){this.sending=!0,this.sendError=!1;let{projectType:e,features:t}=this.data,n=this.generateQuote(e,t);setTimeout(()=>{this.sending=!1,this.finished=!0,this.messages.push({sender:"bot",text:"\xA1Listo! Aqu\xED tienes tu cotizaci\xF3n estimada:"}),this.messages.push({sender:"bot",text:n}),this.messages.push({sender:"bot",text:"\xBFTe gustar\xEDa recibir esta propuesta por email o agendar una llamada para afinar detalles?"})},1200)})}generateQuote(e,t){let n=800,o="Angular, Node.js, Vercel, SCSS",a="";return e||(e=""),e.toLowerCase().includes("ecommerce")?(n=1800,o="Angular, Node.js, Stripe, Firebase, SCSS",a="Integraci\xF3n de pagos, cat\xE1logo, carrito, panel admin."):e.toLowerCase().includes("landing")?(n=600,o="Angular, SCSS, Vercel",a="Optimizaci\xF3n SEO, animaciones, formulario de contacto."):e.toLowerCase().includes("ia")?(n=2500,o="Angular, Node.js, OpenAI API, SCSS",a="Integraci\xF3n de chatbots, an\xE1lisis de datos, IA generativa."):e.toLowerCase().includes("app")?(n=3e3,o="Angular, Node.js, Firebase, Capacitor, SCSS",a="App m\xF3vil/web, autenticaci\xF3n, notificaciones push."):e.toLowerCase().includes("web")&&(n=1200,o="Angular, Node.js, SCSS, Vercel",a="Sitio institucional, blog, integraci\xF3n CMS."),t&&t.length>40&&(n+=400),`
b>Precio estimado:</b> USD $${n} - $${n+600}
b>Tecnolog\xEDas sugeridas:</b> ${o}
b>Incluye:</b> ${a}
b>Notas:</b> El precio puede variar seg\xFAn requerimientos finales. \xA1Hablemos para afinar tu propuesta!`}restart(){this.messages=[{sender:"bot",text:"\xA1Hola! Soy tu asistente para cotizaciones. \xBFEn qu\xE9 puedo ayudarte hoy?"}],this.userInput="",this.data={},this.sending=!1,this.finished=!1,this.sendError=!1}static{this.\u0275fac=function(t){return new(t||i)(M(L))}}static{this.\u0275cmp=S({type:i,selectors:[["app-brief-ai-chat"]],standalone:!0,features:[A],decls:6,vars:4,consts:[[1,"brief-ai-chat-container"],[1,"brief-ai-chat-messages"],[3,"ngClass",4,"ngFor","ngForOf"],["class","bot",4,"ngIf"],["class","brief-ai-chat-input",3,"ngSubmit",4,"ngIf"],["class","brief-ai-chat-finish",4,"ngIf"],[3,"ngClass"],[1,"msg-bubble"],[1,"bot"],[1,"brief-ai-chat-input",3,"ngSubmit"],["name","userInput","autocomplete","off","placeholder","Escribe tu mensaje...",3,"ngModelChange","ngModel","disabled"],["type","submit",3,"disabled"],[1,"brief-ai-chat-finish"],[3,"click"]],template:function(t,n){t&1&&(c(0,"div",0)(1,"div",1),b(2,W,3,2,"div",2)(3,D,3,0,"div",3),d(),b(4,G,4,3,"form",4)(5,H,3,0,"div",5),d()),t&2&&(r(2),s("ngForOf",n.messages),r(),s("ngIf",n.sending),r(),s("ngIf",!n.finished),r(),s("ngIf",n.finished))},dependencies:[E,k,I,T,B,$,j,N,z,V,F],styles:[".brief-ai-chat-container[_ngcontent-%COMP%]{max-width:420px;margin:2.5rem auto;background:#fff;border-radius:1.1rem;box-shadow:0 4px 24px #14213d11;border:1px solid #e5e5e5;display:flex;flex-direction:column;font-family:inherit;overflow:hidden}.dark-theme[_ngcontent-%COMP%]   .brief-ai-chat-container[_ngcontent-%COMP%]{background:#1a2236;border-color:#223}.brief-ai-chat-messages[_ngcontent-%COMP%]{flex:1 1 auto;padding:1.2rem 1.2rem .5rem;overflow-y:auto;min-height:220px}.msg-bubble[_ngcontent-%COMP%]{background:#f8fafc;color:#14213d;border-radius:.7rem;padding:.7rem 1.1rem;margin-bottom:.5rem;max-width:90%;border:1px solid #e5e5e5;font-size:1.05rem}.user[_ngcontent-%COMP%]   .msg-bubble[_ngcontent-%COMP%]{background:#fca31111;color:#14213d;align-self:flex-end;border:1px solid rgba(252,163,17,.3333333333)}.bot[_ngcontent-%COMP%]   .msg-bubble[_ngcontent-%COMP%]{background:#232b3e;color:#fff;border:1px solid #223}.dark-theme[_ngcontent-%COMP%]   .msg-bubble[_ngcontent-%COMP%]{background:#232b3e;color:#fff;border-color:#223}.brief-ai-chat-input[_ngcontent-%COMP%]{display:flex;border-top:1px solid #e5e5e5;background:none;padding:.7rem 1.2rem;gap:.5rem;align-items:center}.dark-theme[_ngcontent-%COMP%]   .brief-ai-chat-input[_ngcontent-%COMP%]{border-top:1px solid #223}.brief-ai-chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1 1 auto;border:1px solid #e5e5e5;border-radius:.5rem;padding:.7rem 1.1rem;font-size:1rem;background:#fff;color:#14213d;transition:border .2s}.dark-theme[_ngcontent-%COMP%]   .brief-ai-chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#232b3e;color:#fff;border-color:#223}.brief-ai-chat-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border:1px solid #FCA311}.brief-ai-chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fca311 60%,#ffd166);color:#14213d;border:none;border-radius:.5rem;padding:.7rem 1.4rem;font-size:1rem;cursor:pointer;font-weight:700;transition:background .2s,color .2s}.brief-ai-chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background:#e5e5e5;color:#aaa;cursor:not-allowed}.dark-theme[_ngcontent-%COMP%]   .brief-ai-chat-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fca311 60%,#ffd166);color:#223}.brief-ai-chat-finish[_ngcontent-%COMP%]{text-align:center;padding:1.2rem}.brief-ai-chat-finish[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:linear-gradient(90deg,#fca311 60%,#ffd166);color:#14213d;border:none;border-radius:.7rem;padding:.7rem 2.2rem;font-size:1.1rem;font-weight:700;cursor:pointer;margin-top:1rem}.dark-theme[_ngcontent-%COMP%]   .brief-ai-chat-finish[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#223}"]})}}return i})();export{Z as BriefAiChatComponent};
